<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Metas e B√¥nus de Produ√ß√£o</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Focus -->
    <!-- Application Structure Plan: A single-page dashboard designed for production team members. The structure is task-oriented, allowing users to first understand the system, then interactively simulate their daily performance, and finally project their monthly bonus eligibility. This flow transforms a static document into a practical tool, starting with general information and moving to personalized calculations, which enhances engagement and understanding of how daily work impacts bonuses. -->
    <!-- Visualization & Content Choices: The core of the app is interactive calculators, not static charts. For the 'Daily Goal', a dynamic progress bar (HTML/CSS) was chosen over a complex chart library for its simplicity and immediate visual feedback. For the 'Points Table', an interactive filter was implemented to turn a static data table into a quick-reference tool. A new LLM-powered "Order Suggestion" feature helps users strategize to hit daily goals, offering direct value through AI-driven insights. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F9F9F7; /* Warm Neutral Background */
        }
        .card {
            background-color: #FFFFFF;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: all 0.3s ease-in-out;
        }
        .card:hover {
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            transform: translateY(-2px);
        }
        .btn-primary {
            background-color: #4A5568; /* Dark Gray-Blue */
            color: white;
            transition: background-color 0.3s;
        }
        .btn-primary:hover {
            background-color: #2D3748; /* Darker Gray-Blue */
        }
        .progress-bar-bg {
            background-color: #E2E8F0; /* Gray 200 */
        }
        .progress-bar-fill {
            background-color: #48BB78; /* Green 500 */
            transition: width 0.5s ease-in-out;
        }
        .highlight {
            color: #C05621; /* Accent Orange */
            font-weight: 700;
        }
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4A5568;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-6xl">

        <header class="text-center mb-10">
            <img src="https://i.imgur.com/hPzGCZ7.png" alt="Logotipo da Empresa" class="mx-auto mb-4 rounded-md shadow-md h-16 w-auto max-w-full" onerror="this.onerror=null;this.src='https://placehold.co/150x50/CCCCCC/666666?text=Logo+Empresa';" />
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-2">Painel de Metas e B√¥nus</h1>
            <p class="text-lg text-gray-600">Sua ferramenta para calcular pontos e simular sua bonifica√ß√£o.</p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">

            <div class="lg:col-span-2 space-y-8">
                
                <section id="daily-simulator" class="card p-6">
                    <h2 class="text-2xl font-bold mb-4 flex items-center">
                        <span class="text-2xl mr-3">üóìÔ∏è</span> Simulador de Produ√ß√£o Di√°ria
                    </h2>
                    <p class="text-gray-600 mb-6">Adicione os pedidos que voc√™ produziu hoje para calcular seus pontos e ver seu progresso em rela√ß√£o √† meta di√°ria de <span class="highlight">6,7 pontos</span>.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="md:col-span-2">
                            <label for="order-select" class="block text-sm font-medium text-gray-700 mb-1">Selecione o Pedido</label>
                            <select id="order-select" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-gray-500 focus:border-gray-500"></select>
                        </div>
                        <div class="flex items-end">
                            <button id="add-order-btn" class="w-full btn-primary font-bold py-2 px-4 rounded-md h-10">Adicionar</button>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h3 class="font-semibold mb-2">Pedidos Adicionados:</h3>
                        <ul id="daily-orders-list" class="list-disc list-inside bg-gray-50 p-4 rounded-md min-h-[80px] text-gray-700">
                            <li id="empty-list-item" class="text-gray-500">Nenhum pedido adicionado ainda.</li>
                        </ul>
                    </div>

                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="text-lg font-bold">Total de Pontos Di√°rios: <span id="daily-total-points" class="highlight">0.00</span></h3>
                            <button id="reset-daily-btn" class="text-sm text-gray-500 hover:text-gray-800">Limpar</button>
                        </div>
                        <div class="w-full progress-bar-bg rounded-full h-4">
                            <div id="daily-progress-bar" class="progress-bar-fill h-4 rounded-full" style="width: 0%;"></div>
                        </div>
                        <p id="progress-text" class="text-right text-sm mt-1 text-gray-600">0% da meta di√°ria</p>
                    </div>

                    <div class="mt-8 pt-6 border-t border-gray-200">
                        <h3 class="text-xl font-bold mb-4 flex items-center">‚ú® Sugest√£o de Pedidos para Meta Di√°ria ‚ú®</h3>
                        <p class="text-gray-600 mb-4">Clique no bot√£o para receber uma sugest√£o de combina√ß√£o de pedidos que o ajude a atingir a meta di√°ria de 6,7 pontos, vinda diretamente da nossa intelig√™ncia artificial.</p>
                        <button id="suggest-orders-btn" class="w-full btn-primary font-bold py-2 px-4 rounded-md flex items-center justify-center">
                            <span id="suggest-button-text">Gerar Sugest√£o</span>
                            <div id="suggest-loading-spinner" class="loading-spinner ml-2 hidden"></div>
                        </button>
                        <div id="suggestion-output" class="mt-4 p-4 bg-blue-50 text-blue-800 rounded-md hidden"></div>
                    </div>
                </section>

                <section id="monthly-simulator" class="card p-6">
                    <h2 class="text-2xl font-bold mb-4 flex items-center">
                        <span class="text-2xl mr-3">üèÜ</span> Simulador de B√¥nus Mensal
                    </h2>
                    <p class="text-gray-600 mb-6">Para se qualificar para o b√¥nus, voc√™ precisa atingir no m√≠nimo <span class="highlight">80%</span> da meta de pontos do m√™s. Insira seus pontos acumulados para ver sua elegibilidade.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="monthly-points-input" class="block text-sm font-medium text-gray-700 mb-1">Seus pontos totais no m√™s</label>
                            <input type="number" id="monthly-points-input" placeholder="Ex: 135.5" class="w-full p-2 border border-gray-300 rounded-md shadow-sm">
                        </div>
                        <div>
                            <label for="working-days-input" class="block text-sm font-medium text-gray-700 mb-1">Dias √∫teis no m√™s</label>
                            <input type="number" id="working-days-input" value="22" class="w-full p-2 border border-gray-300 rounded-md shadow-sm">
                        </div>
                    </div>
                    
                    <div id="monthly-result" class="mt-6 p-4 rounded-md text-center hidden">
                        <p id="monthly-result-text" class="font-semibold"></p>
                        <p id="monthly-details-text" class="text-sm"></p>
                    </div>
                </section>

            </div>

            <div class="space-y-8">
                <section id="rules" class="card p-6">
                    <h2 class="text-xl font-bold mb-4">Como Funciona</h2>
                    <ul class="space-y-3 text-gray-700">
                        <li class="flex items-start">
                            <span class="text-green-500 mr-2 mt-1">‚úì</span>
                            <span>Cada pedido vale pontos, calculados com base no tempo de produ√ß√£o dividido por 60.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-500 mr-2 mt-1">‚úì</span>
                            <span>A meta di√°ria √© de <span class="font-bold">6,7 pontos</span> para manter o ritmo.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-500 mr-2 mt-1">‚úì</span>
                            <span>Para se qualificar ao b√¥nus, atinja no m√≠nimo <span class="font-bold">80% da meta mensal</span>.</span>
                        </li>
                    </ul>
                </section>

                <section id="ranking" class="card p-6">
                    <h2 class="text-xl font-bold mb-4">Ranking de B√¥nus</h2>
                    <p class="text-gray-600 mb-4">Os colaboradores qualificados com mais pontos no m√™s recebem um b√¥nus extra:</p>
                    <ul class="space-y-3">
                        <li class="flex items-center p-3 bg-yellow-100 rounded-lg">
                            <span class="text-2xl mr-3">ü•á</span>
                            <span class="font-bold text-yellow-800">1¬∫ Lugar: R$ 200,00</span>
                        </li>
                        <li class="flex items-center p-3 bg-gray-200 rounded-lg">
                            <span class="text-2xl mr-3">ü•à</span>
                            <span class="font-bold text-gray-800">2¬∫ Lugar: R$ 100,00</span>
                        </li>
                        <li class="flex items-center p-3 bg-orange-200 rounded-lg">
                            <span class="text-2xl mr-3">ü•â</span>
                            <span class="font-bold text-orange-800">3¬∫ Lugar: R$ 50,00</span>
                        </li>
                    </ul>
                </section>
                
                <section id="points-table-section" class="card p-6">
                    <h2 class="text-xl font-bold mb-4">Tabela de Pontos</h2>
                    <input type="text" id="table-filter" placeholder="Filtrar por dimens√£o ou qtd..." class="w-full p-2 mb-4 border border-gray-300 rounded-md">
                    <div class="max-h-64 overflow-y-auto">
                        <table class="w-full text-sm text-left">
                            <thead class="text-xs text-gray-700 uppercase bg-gray-100 sticky top-0">
                                <tr>
                                    <th scope="col" class="px-4 py-2">Pedido</th>
                                    <th scope="col" class="px-4 py-2 text-right">Pontos</th>
                                </tr>
                            </thead>
                            <tbody id="points-table-body">
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const ordersData = [
                { name: '40x50 - 1.000', points: 1.83 }, { name: '40x50 - 500', points: 1.00 }, { name: '40x50 - 250', points: 0.58 }, { name: '40X50 - 100', points: 0.42 },
                { name: '30x40 - 1.000', points: 1.17 }, { name: '30x40 - 500', points: 0.67 }, { name: '30x40 - 250', points: 0.50 }, { name: '30x40 - 100', points: 0.25 },
                { name: '25x35 - 1.000', points: 1.17 }, { name: '25x35 - 500', points: 0.67 }, { name: '25x35 - 250', points: 0.50 }, { name: '25x35 - 100', points: 0.25 },
                { name: '20x30 - 1.000', points: 1.08 }, { name: '20x30 - 500', points: 0.62 }, { name: '20x30 - 250', points: 0.45 }, { name: '20x30 - 100', points: 0.25 },
                { name: '16x22 - 1.000', points: 1.00 }, { name: '16x22 - 500', points: 0.58 }, { name: '16x22 - 250', points: 0.42 }, { name: '16x22 - 100', points: 0.22 }
            ];

            const DAILY_GOAL = 6.7;
            let dailyOrders = [];

            const orderSelect = document.getElementById('order-select');
            const addOrderBtn = document.getElementById('add-order-btn');
            const dailyOrdersList = document.getElementById('daily-orders-list');
            const emptyListItem = document.getElementById('empty-list-item');
            const dailyTotalPointsEl = document.getElementById('daily-total-points');
            const dailyProgressBar = document.getElementById('daily-progress-bar');
            const progressText = document.getElementById('progress-text');
            const resetDailyBtn = document.getElementById('reset-daily-btn');
            const pointsTableBody = document.getElementById('points-table-body');
            const tableFilter = document.getElementById('table-filter');
            const monthlyPointsInput = document.getElementById('monthly-points-input');
            const workingDaysInput = document.getElementById('working-days-input');
            const monthlyResult = document.getElementById('monthly-result');
            const monthlyResultText = document.getElementById('monthly-result-text');
            const monthlyDetailsText = document.getElementById('monthly-details-text');
            const suggestOrdersBtn = document.getElementById('suggest-orders-btn');
            const suggestButtonText = document.getElementById('suggest-button-text');
            const suggestLoadingSpinner = document.getElementById('suggest-loading-spinner');
            const suggestionOutput = document.getElementById('suggestion-output');


            function populateDropdownAndTable() {
                orderSelect.innerHTML = '';
                pointsTableBody.innerHTML = '';
                ordersData.forEach(order => {
                    const option = document.createElement('option');
                    option.value = JSON.stringify(order);
                    option.textContent = `${order.name} (${order.points} pts)`;
                    orderSelect.appendChild(option);

                    const row = document.createElement('tr');
                    row.className = 'bg-white border-b';
                    row.innerHTML = `
                        <td class="px-4 py-2 font-medium text-gray-900 whitespace-nowrap">${order.name}</td>
                        <td class="px-4 py-2 text-right">${order.points.toFixed(2)}</td>
                    `;
                    pointsTableBody.appendChild(row);
                });
            }

            function updateDailySimulator() {
                if (dailyOrders.length === 0) {
                    emptyListItem.style.display = 'list-item';
                    dailyOrdersList.innerHTML = '';
                    dailyOrdersList.appendChild(emptyListItem);
                } else {
                    emptyListItem.style.display = 'none';
                    dailyOrdersList.innerHTML = '';
                    dailyOrders.forEach((order) => {
                        const li = document.createElement('li');
                        li.textContent = `${order.name} - ${order.points.toFixed(2)} pontos`;
                        dailyOrdersList.appendChild(li);
                    });
                }

                const totalPoints = dailyOrders.reduce((sum, order) => sum + order.points, 0);
                dailyTotalPointsEl.textContent = totalPoints.toFixed(2);

                const percentage = Math.min((totalPoints / DAILY_GOAL) * 100, 100);
                dailyProgressBar.style.width = `${percentage}%`;
                progressText.textContent = `${Math.round(percentage)}% da meta di√°ria`;
            }

            function handleAddOrder() {
                const selectedOrder = JSON.parse(orderSelect.value);
                dailyOrders.push(selectedOrder);
                updateDailySimulator();
            }

            function handleResetDaily() {
                dailyOrders = [];
                updateDailySimulator();
            }

            function handleFilterTable() {
                const filterText = tableFilter.value.toLowerCase();
                const rows = pointsTableBody.getElementsByTagName('tr');
                Array.from(rows).forEach(row => {
                    const cellText = row.cells[0].textContent.toLowerCase();
                    row.style.display = cellText.includes(filterText) ? '' : 'none';
                });
            }
            
            function calculateMonthlyBonus() {
                const userPoints = parseFloat(monthlyPointsInput.value);
                const workingDays = parseInt(workingDaysInput.value);

                monthlyResult.classList.add('hidden');

                if (isNaN(userPoints) || isNaN(workingDays) || userPoints <= 0 || workingDays <= 0) {
                    return;
                }

                const monthlyGoal = DAILY_GOAL * workingDays;
                const qualificationThreshold = monthlyGoal * 0.80;
                
                monthlyResult.classList.remove('hidden');
                
                if (userPoints >= qualificationThreshold) {
                    monthlyResult.className = 'mt-6 p-4 rounded-md text-center bg-green-100 text-green-800';
                    monthlyResultText.textContent = 'üéâ Qualificado para o B√¥nus!';
                    monthlyDetailsText.textContent = `Voc√™ atingiu ${userPoints.toFixed(2)} pontos, superando o m√≠nimo de ${qualificationThreshold.toFixed(2)} pontos necess√°rios.`;
                } else {
                    monthlyResult.className = 'mt-6 p-4 rounded-md text-center bg-red-100 text-red-800';
                    monthlyResultText.textContent = '‚ö†Ô∏è Ainda n√£o qualificado';
                    monthlyDetailsText.textContent = `Voc√™ precisa de pelo menos ${qualificationThreshold.toFixed(2)} pontos para se qualificar. Faltam ${(qualificationThreshold - userPoints).toFixed(2)} pontos.`;
                }
            }

            let chatHistory = [];
            const RETRY_DELAY_MS = 1000;
            const MAX_RETRIES = 5;

            async function callGeminiApi(prompt, retries = 0) {
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        if (response.status === 429 && retries < MAX_RETRIES) {
                            await new Promise(res => setTimeout(res, RETRY_DELAY_MS * Math.pow(2, retries)));
                            return callGeminiApi(prompt, retries + 1);
                        }
                        throw new Error(`Erro na API: ${response.statusText}`);
                    }

                    const result = await response.json();
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        chatHistory.push({ role: "model", parts: [{ text: text }] });
                        return text;
                    } else {
                        throw new Error('Resposta da API inesperada ou conte√∫do ausente.');
                    }
                } catch (error) {
                    console.error('Erro ao chamar a API Gemini:', error);
                    return 'Desculpe, n√£o foi poss√≠vel gerar uma sugest√£o no momento. Tente novamente mais tarde.';
                }
            }

            async function handleSuggestOrders() {
                suggestButtonText.textContent = 'Gerando...';
                suggestLoadingSpinner.classList.remove('hidden');
                suggestOrdersBtn.disabled = true;
                suggestionOutput.classList.add('hidden');
                suggestionOutput.innerHTML = '';

                const ordersListFormatted = ordersData.map(o => `${o.name} (${o.points} pontos)`).join(', ');
                const prompt = `Dada a seguinte lista de pedidos de produ√ß√£o com seus respectivos pontos: ${ordersListFormatted}. A meta di√°ria de produ√ß√£o √© de ${DAILY_GOAL} pontos. Sugira uma combina√ß√£o desses pedidos que, quando somados, se aproximem o m√°ximo poss√≠vel de ${DAILY_GOAL} pontos sem exceder significativamente. Forne√ßa uma lista clara dos pedidos sugeridos e o total de pontos. Explique brevemente o seu racioc√≠nio. N√£o inclua texto introdutorio ou conclusivo conversacional.`;

                const suggestion = await callGeminiApi(prompt);
                
                suggestionOutput.innerHTML = suggestion;
                suggestionOutput.classList.remove('hidden');
                suggestButtonText.textContent = 'Gerar Sugest√£o';
                suggestLoadingSpinner.classList.add('hidden');
                suggestOrdersBtn.disabled = false;
            }

            addOrderBtn.addEventListener('click', handleAddOrder);
            resetDailyBtn.addEventListener('click', handleResetDaily);
            tableFilter.addEventListener('input', handleFilterTable);
            monthlyPointsInput.addEventListener('input', calculateMonthlyBonus);
            workingDaysInput.addEventListener('input', calculateMonthlyBonus);
            suggestOrdersBtn.addEventListener('click', handleSuggestOrders);

            populateDropdownAndTable();
            updateDailySimulator();
        });
    </script>
</body>
</html>
